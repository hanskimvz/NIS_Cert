# 34장 IP카메라 보안요구사항 V3.0

> 국가·공공기관 도입 IT보안제품에 대한 국가용 보안요구사항 (2024. 4. 3.)

---

## 1절 일반사항

### 1. 운용 환경 정의

#### 1.1 가정사항

| 항목 | 내용 |
|------|------|
| 패치 관리 | 인가된 관리자가 펌웨어 및 소프트웨어에 대한 최신 패치를 정기적으로 수행 |
| 접속 방식 | 웹브라우저 등을 통해 제품 접속, **HTTPS, TLS, SSH** 등 암호통신 프로토콜 사용 |
| 접속 제한 | 로컬콘솔 형태의 접속 불가, **웹 브라우저**가 최초 및 운용을 위한 기본 접속 수단 |

#### 1.2 제품 개요

**IP카메라 정의:**
- 사람 또는 사물의 **영상 촬영** 기능
- 선택적으로 **오디오 획득** 가능
- 영상과 오디오를 **IP 네트워크**를 통하여 전송
- **하드웨어 일체형 장비**

**포함 구성요소:**
- 이미지 센서 (영상 획득)
- 마이크 (오디오 획득)
- 미디어 서버 (영상 송신)
- 웹 서버 (제어·관리)

**전송 데이터:**
- 영상 (이미지 또는 비디오) - 필수
- 오디오 - 관리자 선택에 따라 포함 가능

---

### 2. 운용 환경

#### 2.1 네트워크 구성 원칙

| 구분 | 요구사항 |
|------|----------|
| **원칙** | 인터넷 및 업무·행정망과 **분리된 별도 단독망** 구성 |
| **예외** | 원격지 등 단독망 구성 불가 시 **VPN 등 암호화된 통신 구간**에서 운용 |

#### 2.2 운용 환경 구성요소

- IP카메라
- 영상정보 관리·저장제품 (연동)
- 관리 단말(PC) - 웹브라우저 접속
- 로그 서버 (외부 저장 및 관리)
- NTP 서버 (시간 동기화)
- 기타 기능 활용을 위한 외부 실체

#### 2.3 제품 상태 정의

| 상태 | 정의 |
|------|------|
| **기본(default) 상태** | 최초 관리자계정·비밀번호 설정 및 변경이 진행되지 **않은** 상태 |
| **운용 상태** | 최초 관리자계정·비밀번호 설정 및 변경이 **완료된** 상태 |

#### 2.4 식별 및 인증 대상

- **관리자**: 제품의 식별 및 인증 대상
- **영상 모니터링 관리자**: 영상만 취득하고자 하는 사용자도 식별 및 인증 대상에 포함

---

### 3. 운용환경 요구사항

#### 준수해야 할 지침 및 가이드

| 분야 | 명칭 | 주관기관 |
|------|------|----------|
| 공공 | 국가정보보안기본지침 | 국가정보원 |
| 공공 | 국가·공공기관 영상정보처리기기 도입·운영 가이드 | 국가정보원 |
| 공공 | 공공기관 고정형 영상정보처리기기 설치·운영 가이드 | 개인정보보호위원회 |

---

## 2절 보안기능 요구사항

### 1. 식별 및 인증

#### 1.1 인증 프로토콜

| 접속 방식 | 프로토콜 | 인증 방식 | 비고 |
|-----------|----------|-----------|------|
| 웹 브라우저 | HTTPS | Digest 인증 | TLS 암호화 채널 위에서 동작 |
| WebSocket | WSS | Digest 인증 | HTTPS와 동일 세션 공유 가능 |
| ONVIF | HTTPS | WS-UsernameToken (Digest) | ONVIF 표준 인증 |
| RTSPS | RTSPS | Digest 인증 | RFC 7826 |
| 터미널 | SSH | 공개키 또는 비밀번호 | SSH 프로토콜 자체 암호화 |

#### 1.2 비밀번호 정책

##### ✅ 준수 항목 (필수)

| 항목 | 요구사항 | 비고 |
|------|----------|------|
| 최소 길이 | **9자리 이상** | 필수 |
| 대문자 포함 | 영문 대문자 1자 이상 포함 | A-Z |
| 소문자 포함 | 영문 소문자 1자 이상 포함 | a-z |
| 숫자 포함 | 숫자 1자 이상 포함 | 0-9 |
| 특수문자 포함 | 특수문자 1자 이상 포함 | !@#$%^&*() 등 |
| 복잡도 | 위 4가지 유형 모두 혼합 사용 | 필수 |

##### ❌ 금지 항목

| 항목 | 금지 내용 | 예시 |
|------|-----------|------|
| ID 포함 금지 | 비밀번호에 사용자 ID와 동일한 문자열 포함 금지 | ID가 `admin`이면 `admin123!` 금지 |
| 동일 문자 연속 | 동일한 문자 또는 숫자 연속 사용 금지 | `aaa`, `111`, `!!!` 금지 |
| 순차적 문자 | 키보드 연속 문자 순차 나열 금지 | `qwerty`, `asdf`, `1234` 금지 |
| 순차적 숫자 | 연속된 숫자 순차 나열 금지 | `123456`, `987654` 금지 |
| 이전 비밀번호 | 직전 사용 비밀번호 재사용 금지 | 최소 1회 이상 이력 관리 |

##### 📋 비밀번호 검증 규칙 요약

```
비밀번호 유효성 검사:
├── ✅ 길이 >= 9자
├── ✅ 대문자 포함 (A-Z)
├── ✅ 소문자 포함 (a-z)
├── ✅ 숫자 포함 (0-9)
├── ✅ 특수문자 포함
├── ❌ ID 문자열 미포함
├── ❌ 동일 문자/숫자 3회 이상 연속 불가 (예: aaa, 111)
├── ❌ 키보드 순차 문자 3자 이상 불가 (예: qwe, asd)
├── ❌ 순차 숫자 3자 이상 불가 (예: 123, 987)
└── ❌ 직전 비밀번호와 동일 불가
```

#### 1.3 인증 실패 처리

| 항목 | 설정 | 비고 |
|------|------|------|
| 연속 실패 허용 횟수 | 5회 | 설정 가능 |
| 계정 잠금 | 연속 실패 시 계정 잠금 | 필수 |
| 잠금 해제 | **5분 후 자동 해제 (재시도 허용)** | 시간 경과 후 재인증 가능 |
| 실패 로그 | 인증 실패 이벤트 로그 기록 | 필수 |
| **관리자 알림** | **이메일(SMTP)로 알림 발송** | 연속 실패 시 즉시 통보 |

##### 📧 이메일 알림 (SMTP)

**구조:**
```
┌─────────────────────────────────────────────────────────────┐
│                    이메일 알림 구조                          │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│   [IP카메라]                      [외부 SMTP 서버]          │
│   ┌──────────────┐               ┌──────────────┐          │
│   │ SMTP 클라이언트│──── TLS ────▶│ 고객사 SMTP  │          │
│   │ (발신 전용)   │               │ 서버         │          │
│   └──────────────┘               └──────────────┘          │
│         │                               │                   │
│    인증 실패 감지                        ▼                   │
│    (5회 연속)                     [관리자 이메일]            │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

**SMTP 설정 항목 (웹페이지에서 설정):**

| 항목 | 설명 | 예시 |
|------|------|------|
| SMTP 서버 주소 | 외부 메일 서버 호스트명/IP | `smtp.company.com` |
| 포트 | SMTP 포트 | **587 (TLS 권장)**, 465(SSL), 25 |
| 암호화 | 통신 암호화 방식 | **TLS/STARTTLS 필수** |
| 인증 사용 | SMTP 인증 여부 | 사용 (권장) |
| 사용자명 | SMTP 인증 계정 | `alert@company.com` |
| 비밀번호 | SMTP 인증 비밀번호 | 암호화 저장 필수 |
| 발신자 주소 | From 주소 | `ipcam-alert@company.com` |
| 수신자 주소 | 관리자 이메일 (복수 가능) | `admin@company.com` |

**알림 이벤트:**

| 이벤트 | 알림 여부 | 우선순위 |
|--------|-----------|----------|
| 인증 연속 실패 (계정 잠금) | ✅ 필수 | 🔴 높음 |
| 인증서 만료 임박 | ✅ 권장 | 🔴 높음 |
| 펌웨어 업데이트 결과 | 선택 | 🟡 중간 |
| 시스템 재시작 | 선택 | 🟢 낮음 |

**보안 요구사항:**

| 항목 | 요구사항 |
|------|----------|
| TLS 암호화 | SMTP 통신 시 TLS(STARTTLS) 필수 |
| 비밀번호 저장 | SMTP 계정 비밀번호 암호화 저장 |
| 테스트 기능 | 설정 완료 후 테스트 메일 발송 기능 제공 |
| 발송 실패 | 메일 발송 실패 시 로그 기록 |

#### 1.4 기본 비밀번호 정책

| 항목 | 요구사항 |
|------|----------|
| 출하 시 상태 | 기본 비밀번호 없음  |
| 최초 접속 | 비밀번호 설정 강제 (설정 전 기능 사용 불가) |
| 비밀번호 변경 | 위 비밀번호 정책 준수 필수 |

#### 1.5 비밀번호 입력 UI (2.5.1)

> **요구사항:** 제품은 인증에서 사용되는 정보를 출력장치에 표시할 때 내용을 표시하지 않아야 한다

| 항목 | 요구사항 | 비고 |
|------|----------|------|
| 비밀번호 마스킹 | 입력 시 `*****` 형태로 표시 | **필수** |
| 보기 토글 | **금지** (비밀번호 표시 전환 기능 제공 불가) | 2.5.1 준수 |
| 평문 표시 | **금지** (어떤 경우에도 비밀번호 평문 노출 불가) | 2.5.1 준수 |
| 복사/붙여넣기 | 비밀번호 필드 복사 기능 비활성화 | 보안 강화 |

---

### 2. 접근통제

#### 2.1 관리자 권한 관리

| 역할 | 권한 | 비고 |
|------|------|------|
| 슈퍼 관리자 | 모든 설정 변경, 사용자 관리 | 최초 설정 계정 |
| 일반 관리자 | 장치 설정 변경 | 사용자 관리 제외 |
| 영상 모니터링 | 영상 조회만 가능 | 설정 변경 불가 |

#### 2.2 세션 관리

##### 세션 설정 항목

| 항목 | 설정값 | 비고 |
|------|--------|------|
| 세션 타임아웃 | 10분 (권장) | 미사용 시 자동 로그아웃 |
| 최대 동시 세션 | 제한 (예: 5개) | 동일 계정 동시 접속 제한 |
| 세션 ID | 랜덤 생성, 예측 불가 | 보안 강화 |
| 세션 갱신 | 활동 시 세션 연장 | 사용자 편의 |
| 로그아웃 | 명시적 로그아웃 기능 제공 | 세션 즉시 무효화 |

##### 세션 보안 설정

| 항목 | 설정 | 비고 |
|------|------|------|
| 쿠키 Secure 플래그 | 활성화 | HTTPS에서만 쿠키 전송 |
| 쿠키 HttpOnly 플래그 | 활성화 | JavaScript 접근 차단 |
| 쿠키 SameSite 속성 | Strict 또는 Lax | CSRF 공격 방지 |
| 세션 고정 방지 | 로그인 시 세션 ID 재생성 | 세션 하이재킹 방지 |

##### 세션 관리 흐름

```
┌─────────────────────────────────────────────────────────────┐
│                      세션 관리 흐름                          │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  [로그인 요청] ──▶ [인증 성공] ──▶ [세션 생성]               │
│                         │                                   │
│                         ▼                                   │
│                   [세션 ID 발급]                             │
│                   (Secure, HttpOnly 쿠키)                   │
│                         │                                   │
│                         ▼                                   │
│  ┌──────────────────────────────────────────┐               │
│  │              세션 유효 상태               │               │
│  │  • 활동 시 타임아웃 갱신                  │               │
│  │  • 미활동 10분 → 자동 로그아웃            │               │
│  └──────────────────────────────────────────┘               │
│                         │                                   │
│           ┌─────────────┼─────────────┐                     │
│           ▼             ▼             ▼                     │
│      [명시적       [타임아웃      [강제                      │
│       로그아웃]     만료]         로그아웃]                  │
│           │             │             │                     │
│           └─────────────┴─────────────┘                     │
│                         │                                   │
│                         ▼                                   │
│                   [세션 무효화]                              │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

---

### 3. 암호화

#### 3.1 통신 암호화
- 관리 접속 시 **HTTPS, TLS, SSH** 등 암호통신 프로토콜 사용 필수
- 영상 데이터 전송 시 암호화 권장 (SRTP, RTSPS 등)

#### 3.2 저장 데이터 보호
- 민감 정보(비밀번호 등) 암호화 저장

---

### 4. 감사 기록

#### 4.1 로그 생성
- 관리자 접속, 설정 변경, 인증 실패 등 주요 이벤트 로그 기록
- 로그에 타임스탬프 포함

#### 4.2 로그 보호
- 로그의 무단 수정 및 삭제 방지
- 외부 로그 서버 전송 기능 지원

---

### 5. 소프트웨어 보안

#### 5.1 펌웨어 무결성
- 펌웨어 업데이트 시 무결성 검증 수행
- 서명된 펌웨어만 설치 허용

#### 5.2 보안취약점 관리
- 사용 중인 프로토콜, 라이브러리, 오픈소스 취약점 점검
- 취약한 버전의 커널(Linux 2.x 등) 사용 금지 권고

#### 5.3 불필요한 서비스 제거
- 필수 서비스만 활성화
- 불필요 서비스는 제거 또는 비활성화

---

## 별표 1: 영상 전송 관련 표준 프로토콜

| 프로토콜 | 동작 형태 | 비고 |
|----------|-----------|------|
| **ONVIF** | HTTPS/TCP, HTTP/TCP | www.onvif.org, IEC 60839-11-31:2016, SOAP 기반 HTTP/XML 메시지 |
| **RTP** | RTP/TCP, RTP/UDP | RFC 3550, 실질적 Video/Audio 데이터 전송 |
| **RTSP** | RTSP/TCP, RTSP/UDP | RFC 2326, RTP 스트림 제어 |
| **SRTP** | SRTP/TCP, SRTP/UDP | RFC 3711, RFC 5763, RTP 패킷 **암호화** 전송 |
| **RTSPS** | RTP/RTSP/TLS | RFC 7826, RTSP 패킷 **암호화** 전송 |
| **HTTP Tunneling** | RTP/RTSP/HTTP(S)/TCP | RTP/RTSP 데이터를 HTTP Payload에 포함 전송 |
| **Websocket** | RTP/RTSP/HTTP(S)/TCP | RFC 6455, Websocket 내 RTP/RTSP 데이터 전송 |

---

## 핵심 요약 체크리스트

| 구분 | 요구사항 | 필수여부 |
|------|----------|----------|
| 🔐 암호화 | HTTPS, TLS, SSH 등 암호통신 프로토콜 사용 | ✅ 필수 |
| 🌐 네트워크 | 인터넷/업무망과 분리된 단독망 구성 | ✅ 원칙 |
| 🔒 VPN | 단독망 불가 시 암호화된 VPN 구간에서 운용 | ✅ 예외 시 필수 |
| 👤 인증 | 관리자 및 영상 모니터링 관리자 식별·인증 | ✅ 필수 |
| 🔑 계정 | 최초 관리자 계정·비밀번호 설정 필수 | ✅ 필수 |
| 📺 접속 | 웹브라우저가 기본 접속 수단 | ✅ 필수 |
| 🔄 패치 | 펌웨어/소프트웨어 최신 패치 정기 수행 | ✅ 필수 |
| 📝 로그 | 주요 이벤트 감사 기록 및 보호 | ✅ 필수 |
| 🛡️ 무결성 | 펌웨어 업데이트 시 무결성 검증 | ✅ 필수 |
| 🚫 서비스 | 불필요한 서비스 제거/비활성화 | ✅ 필수 |

---

## 당사 보안 전략

### 1. 사용 프로토콜 (모두 암호화)

| 프로토콜 | 포트 | 용도 | 암호화 방식 |
|----------|------|------|-------------|
| **HTTPS** | 443 | 웹 관리 인터페이스 | TLS |
| **WSS** | 443 (또는 별도) | WebSocket 실시간 통신 | TLS |
| **ONVIF** | 443 | 장치 검색/설정/PTZ 제어 | HTTPS (TLS) |
| **RTSPS** | 322 (기본) | 영상/오디오 스트리밍 | TLS |
| **SSH** | 22 | 터미널 접속/유지보수 | SSH |

### 2. 통신 구조도

```
┌─────────────────────────────────────────────────────────────┐
│                    모든 통신 암호화 ✅                       │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│   [웹 브라우저] ──HTTPS──▶ [IP카메라 웹서버]                 │
│                                                             │
│   [웹 브라우저] ──WSS────▶ [IP카메라] (실시간 이벤트/제어)   │
│                                                             │
│   [VMS/NVR] ────ONVIF───▶ [IP카메라] (장치 검색/설정)       │
│              (HTTPS 기반)                                   │
│                                                             │
│   [VMS/NVR] ────RTSPS───▶ [IP카메라] (영상 스트리밍)        │
│              (TLS 암호화)                                   │
│                                                             │
│   [관리자 PC] ──SSH─────▶ [IP카메라] (터미널 접속)          │
│              (SSH 암호화)                                   │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 3. 비활성화/제거 대상 프로토콜

| 프로토콜 | 제거 이유 |
|----------|-----------|
| HTTP | 비암호화 웹 통신 |
| WS | 비암호화 WebSocket |
| RTP | 비암호화 영상 전송 |
| RTSP | 비암호화 스트리밍 |
| Telnet | 비암호화 터미널 (절대 사용 금지) |
| FTP | 비암호화 파일 전송 |

### 4. SSH 보안 권장사항

| 항목 | 권장 설정 |
|------|-----------|
| 인증 방식 | 공개키 인증 권장 (비밀번호 인증보다 안전) |
| 기본 포트 | 22 → 다른 포트로 변경 가능 |
| 접속 제한 | 특정 IP 대역만 허용 (방화벽/ACL) |
| root 접속 | 비활성화 권장 |
| 접속 실패 | 연속 실패 시 계정 잠금 |

### 5. 보안요구사항 충족 여부

| 요구사항 | 충족 | 적용 프로토콜 |
|----------|------|---------------|
| 암호통신 프로토콜 사용 | ✅ | HTTPS, WSS, RTSPS, SSH |
| 관리 접속 암호화 | ✅ | HTTPS, WSS, SSH |
| 영상 전송 암호화 | ✅ | RTSPS (RFC 7826) |
| 표준 프로토콜 사용 | ✅ | ONVIF, RTSPS (별표1 명시) |
| 불필요 서비스 제거 | ✅ | HTTP, RTP, RTSP 등 비활성화 |

---

## 제·개정 이력

| 일자 | 주요 변경 내용 | 문서 버전 |
|------|----------------|-----------|
| 2024. 4. 3. | IP카메라 보안요구사항 제정 | V3.0 |
| 2025. 11. 28. | '신원정보기반 생체인식제품 보안요구사항'(제21장) 제정에 따른 번호 변경 | V3.0 |


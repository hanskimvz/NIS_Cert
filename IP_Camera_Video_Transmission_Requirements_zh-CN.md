# IP摄像机视频传输安全要求

## 来源
- 影像信息处理设备产品群国家安全要求
- IP摄像机安全要求 V3.0 (第34章)(2024.04.03)

---

### 📋 摘要

**核心原则:** 所有视频传输必须使用基于TLS 1.2以上的加密通信

| 协议 | 加密方式 | 备注 |
|---------|------------|------|
| **RTSP** | RTSPS (RTSP over TLS) | 遵循RFC 7826，使用TLS加密每个RTSP数据包 |
| **RTP** | SRTP (Secure RTP) | RFC 3711，加密每个RTP数据包的数据 |
| **ONVIF** | HTTPS (HTTP over TLS) | 使用TLS加密传输基于SOAP的消息 |
| **管理连接** | HTTPS / SSH V2 | Web管理: HTTPS, CLI管理: SSH V2 |

**认证方式:**
- 使用Digest认证时必须遵循RFC 7616标准
- 加密算法: 安全强度112bit以上

**禁止事项:**
- 不允许使用自定义协议
- 不允许明文传输(HTTP, RTSP)(在运行状态下)

---

## 1. 视频协议认证

### 1.1 (必须) 设备间互联及视频相关标准协议(ONVIF, RTSP等)必须提供用户认证功能

**要求项目**
1. 在ONVIF、RTSP等中使用Digest认证时，必须遵循RFC 7616标准。
2. 用户认证中的加密算法必须使用安全强度112bit以上的标准算法。

---

## 2. 视频传输安全

### 2.1 (必须) 设备间互联及视频传输相关标准协议通信时，必须使用加密通信通道传输以保护传输数据

**要求项目**
1. 为实现加密通信，必须使用标准协议(ONVIF, RTSP等)提供机密性和完整性。
   - 加密通信协议包括HTTPS(使用TLS实现)、TLS(TLS 1.2- RFC5246以上)、SSH(SSH V2-RFC 4251, 4254)等。

2. 不允许使用自定义协议。

3. 使用的加密算法、加密密钥安全性及加密密钥存储方式必须满足"加密支持"要求。

4. 可以使用HTTPS Tunneling(RTP/RTSP/HTTPS/TCP)传输方式。

**检查注意事项**
- 必须使用数据包监控工具确认是否对传输数据提供机密性和完整性。

---

## 3. 传输数据保护 (管理连接)

### 3.1 (必须) 产品在管理连接时必须使用加密通信通道传输以保护传输数据

**要求项目**
1. 为实现加密通信，必须使用标准协议提供机密性和完整性。
   - 加密通信协议包括HTTPS(使用TLS实现)、TLS(TLS 1.2- RFC5246以上)、SSH(SSH V2-RFC 4251, 4254)等。

2. 不允许使用自定义协议。

3. 加密通信通道可以直接在产品中实现，或通过产品利用运行环境来提供。

4. 使用的加密算法、加密密钥安全性及加密密钥存储方式必须满足"加密支持"要求。

**参考事项**
- 产品在默认(default)状态下与管理工具的通信可以不适用此要求。

**检查注意事项**
1. 必须使用数据包监控工具确认是否对传输数据提供机密性和完整性。
2. 测试人员可根据要求，在必要时直接面对开发人员，要求对实现内容进行说明，以准确测试要求的实现。

---

## 4. 传输数据保护 (外部IT实体互联)

### 4.1 (条件必须) 产品与外部IT实体互联时必须使用加密通信通道传输以保护传输数据

**条件:** 支持与外部IT实体互联时

**要求项目**
1. 为实现加密通信，必须使用标准协议提供机密性和完整性。
   - 加密通信协议包括HTTPS(使用TLS实现)、TLS(TLS 1.2-RFC5246以上)、SSH(SSH V2-RFC 4251, 4254)等。

2. 不允许使用自定义协议。

3. 加密通信通道可以直接在产品中实现，或通过产品利用运行环境来提供。

4. 如果产品为提供安全功能而支持与外部IT实体互联的功能，则必须适用此要求。

5. 如果与外部IT实体互联时不使用加密通信通道保护传输数据，则必须证明传输数据机密性、完整性保护的不必要性。

6. 必须能够禁用不支持加密通信通道的通信服务。

7. 使用的加密算法、加密密钥安全性及加密密钥存储方式必须满足"加密支持"要求。

**参考事项**
- 外部IT实体包括认证服务器、SNMP服务器、更新服务器、日志服务器等，与部署机构允许的NTP服务器等的明文通信可以不适用此要求。

**检查注意事项**
1. 如果产品为提供安全功能而支持与外部IT实体互联，则必须适用此要求进行测试。
2. 但是，与外部IT实体中的NTP服务器的通信不适用此要求。
3. 如果支持syslog，必须通过syslog over TLS(RFC 5424)、syslog over DTLS(RFC6012)等支持加密传输。
4. 如果产品没有与外部IT实体互联的功能，则判定为"不适用"。

---

## 5. 视频传输相关标准协议列表

| 协议 | 运行形式 | 备注 |
|---------|----------|------|
| **ONVIF** | HTTPS/TCP, HTTP/TCP | - www.onvif.org<br>- IEC 60839-11-31:2016, IEC 62676-2-31:2019<br>- 基于SOAP的HTTP/XML消息协议 (IP摄像机视频相关信息读/写)<br>- 视频传输采用RTP/RTSP等标准 |
| **RTP** | RTP/TCP, RTP/UDP | - RFC 3550<br>- KS C IEC 62676-2-1:2013<br>- 实际视频和音频数据传输 |
| **RTSP** | RTSP/TCP, RTSP/UDP | - RFC 2326<br>- KS C IEC 62676-2-1:2013<br>- RTP流控制 |
| **SRTP** | SRTP/TCP, SRTP/UDP | - RFC 3711, 5763<br>- RTP协议的扩展版<br>- 加密每个RTP数据包的数据后传输 |
| **RTSPS** | RTP/RTSP/TLS | - RFC 7826<br>- 加密每个RTSP数据包的数据后传输 |
| **HTTP Tunneling** | RTP/RTSP/HTTP(S)/TCP | - 将RTP/RTSP数据放置在HTTP Payload中传输 |
| **Websocket** | RTP/RTSP/HTTP(S)/TCP | - RFC 6455<br>- 在Websocket内传输RTP/RTSP数据 |

---

## 6. 加密算法要求 (视频传输相关)

### 6.1 标准加密算法

| 类别 | 示例 |
|------|------|
| 哈希 | SHA-224以上 |
| 对称密钥加密 | 密钥长度128bit以上 |
| 公钥加密 | RSA 2048以上, DSA(2048, 224)以上 |
| 电子签名 | RSA-PSS 2048以上, KCDSA (2048, 224)以上, ECDSA/EC-KCDSA (B-233, B-283, K-223, P-224, P-256) |

### 6.2 加密使用限制事项
- 不允许使用TDES(包括2 key, 3 key)。
- 使用分组密码时，如果明文大小大于加密块大小，则不应使用ECB模式。
- 使用分组密码时，在CFB或OFB模式下不应使用固定IV。
- 必须使用国内外标准加密算法，建议使用国家级加密算法。

---

## 7. 摘要: 视频传输安全检查清单

| 项目 | 是否必须 | 说明 |
|------|---------|------|
| 视频协议认证 | 必须 | ONVIF, RTSP等中的Digest认证 (RFC 7616) |
| 使用加密通信通道 | 必须 | 使用TLS 1.2以上, SSH V2等标准协议 |
| 禁止自定义协议 | 必须 | 不允许使用自行开发的协议 |
| 加密算法 | 必须 | 安全强度112bit以上的标准算法 |
| 外部IT实体互联 | 条件必须 | 支持互联时必须加密通信 |
| HTTPS Tunneling | 可选 | 可使用RTP/RTSP/HTTPS/TCP方式 |

---

*本文档摘自IP摄像机安全要求V3.0中视频传输功能相关部分。*

